!!! Abstract å¤§å®¶å¥½~æˆ‘æ˜¯`ç±³æ´›`ï¼<br/>
> æˆ‘æ­£åœ¨ä»0åˆ°1æ‰“é€ ä¸€ä¸ªå¼€æºçš„æ¥å£æµ‹è¯•å¹³å°, ä¹Ÿåœ¨ç¼–å†™ä¸€å¥—ä¸ä¹‹å¯¹åº”çš„`æ•™ç¨‹`ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šæ”¯æŒã€‚<br/>
> æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·`ç±³æ´›çš„æµ‹å¼€æ—¥è®°`ï¼Œè·å–æœ€æ–°æ–‡ç« æ•™ç¨‹! 

### å›é¡¾

  æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œç‰¹åˆ«æ˜¯å¾ˆä¹…ä¸æ¥è·Ÿç³»åˆ—çš„è¯»è€…ï¼Œæ¯æ¬¡çœ‹çœ‹å›é¡¾éƒ½æŒºä¸é”™çš„ï¼Œè¿˜è®°å¾—ä¸Šä¸€èŠ‚è®²äº†å•¥ã€‚
  
  ä¸Šä¸€èŠ‚æˆ‘ä»¬ç¼–å†™äº†å¯¼å…¥harçš„æ¥å£ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å°±å®ç°å‰ç«¯éƒ¨åˆ†å»é…åˆå®ƒã€‚
  
### ç¼–å†™å‰ç«¯éƒ¨åˆ†

  è¿˜è®°å¾—ä¹‹å‰æˆ‘ä»¬ç¼–å†™çš„ç”¨ä¾‹å½•åˆ¶é¡µé¢å—ï¼Ÿæˆ‘å†³å®šæŠŠå®ƒçš„tableéƒ¨åˆ†æŠ½ç¦»å‡ºæ¥ï¼Œå› ä¸ºè¿™å—æ˜¯å¯ä»¥å¤ç”¨çš„ã€‚
  
  å¹¶ä¸”æˆ‘ç»™è‡ªå·±å®šäº†ä¸€ä¸ªå°ç›®æ ‡ï¼Œåç»­çš„ç»„ä»¶éƒ½åŸºæœ¬ä¸Šç”¨tsxå¼€å‘ï¼Œè™½ç„¶å¾ˆè‰°éš¾ï¼Œä½†æ˜¯æœ‰å‹åŠ›å°±æœ‰åŠ¨åŠ›ï¼Œä½•å†µtsxå®Œç¾å…¼å®¹jsxã€‚
  
- æå–tableéƒ¨åˆ†ï¼Œæ–°å»ºsrc/components/TestCase/recorder/RequestInfoList.tsx

```tsx
import React from "react";
import type {ColumnsType} from "antd/lib/table/Table";
import {Modal, Table, Tag, Tooltip} from "antd";
import SyntaxHighlighter from "react-syntax-highlighter";
import {vs2015} from "react-syntax-highlighter/dist/cjs/styles/hljs";
import {TableRowSelection} from "antd/lib/table/interface";
import NoRecord from "@/components/NotFound/NoRecord";


interface RequestProps {
  index: number;
  url: string;
  request_method: string;
  status_code: number | string;
  response_headers: string;
  request_headers: string;
  body: string;
}


interface RequestInfoProps {
  dataSource: Array<RequestProps>;
  rowKey?: string;
  rowSelection: TableRowSelection<any>;
  loading?: boolean;
  emptyText?: string | 'æš‚æ— æ•°æ®';
}

interface TagProps {
  color: string;
  fontColor: string;
}

const tagColor = (method: string): TagProps => {
  switch (method.toUpperCase()) {
    case "GET":
      return {color: 'rgb(235, 249, 244)', fontColor: 'rgb(47, 177, 130)'}
    case "POST":
      return {color: 'rgb(242, 244, 248)', fontColor: 'rgb(5, 112, 175)'}
    case "PUT":
      return {color: 'rgb(255, 247, 230)', fontColor: 'rgb(255, 174, 0)'}
    case "DELETE":
      return {color: 'rgb(253, 244, 246)', fontColor: 'rgb(222, 72, 108)'}
    default:
      return {color: 'rgb(243, 251, 254)', fontColor: 'rgb(166, 187, 210)'}
  }
}

const MethodTag = ({color, text, fontColor}) => {
  return <Tag style={{color: fontColor, borderRadius: 12, padding: '0 12px'}} color={color}>{text}</Tag>
}

const Detail = ({name, record}) => {
  return <a onClick={() => {
    Modal.info({
      title: name,
      width: 700,
      bodyStyle: {padding: -12},
      content: <SyntaxHighlighter language="json" style={vs2015}>{record[name]}</SyntaxHighlighter>
    })
  }}>è¯¦ç»†</a>
}

const RequestInfoList: React.FC<RequestInfoProps> = ({dataSource, loading, ...restProps}) => {
  const columns: ColumnsType<RequestProps> = [
    {
      title: 'ç¼–å·',
      key: 'index',
      render: (text, record, index) => `${index + 1}`
    },
    {
      title: 'è¯·æ±‚åœ°å€',
      key: 'url',
      dataIndex: 'url',
      width: '20%',
      render: url => <Tooltip title={url}><a href={url}>{url.slice(0, 48)}</a> </Tooltip>
    },
    {
      title: 'è¯·æ±‚æ–¹å¼',
      key: 'request_method',
      dataIndex: 'request_method',
      render: md => <MethodTag fontColor={tagColor(md).fontColor} color={tagColor(md).color} text={md}/>
    },
    {
      title: 'è¯·æ±‚headers',
      key: 'request_headers',
      dataIndex: 'request_headers',
      render: (request_headers, record): React.ReactNode => {
        return <Detail name="request_headers" record={record}/>
      }
    },
    {
      title: 'è¯·æ±‚å‚æ•°',
      key: 'body',
      dataIndex: 'body',
      render: (body, record) => {
        if (!body) {
          return '-'
        }
        return <Detail name="body" record={record}/>
      }
    },
    {
      title: 'è¿”å›headers',
      key: 'response_headers',
      dataIndex: 'response_headers',
      render: (response_headers, record) => {
        if (!response_headers) {
          return '-'
        }
        return <Detail name="response_headers" record={record}/>
      }
    },
    {
      title: 'response',
      key: 'response_content',
      dataIndex: 'response_content',
      render: (response_content, record) => {
        if (!response_content) {
          return '-'
        }
        return <Detail name="response_content" record={record}/>
      }
    },
  ]


  return (
    <Table columns={columns} pagination={false} dataSource={dataSource}
           rowSelection={restProps.rowSelection} rowKey={record => record[restProps.rowKey]}
           loading={loading} locale={{emptyText: <NoRecord desc={restProps.emptyText} height={150}/>}}/>
  )
}

export default RequestInfoList;

```

  å…¶å®å…·ä½“ç»†èŠ‚ä¹Ÿå¾ˆjsxå·®ä¸å¤šï¼Œç”±äºtsæˆ‘è¿˜ä¸æ˜¯å¾ˆç†Ÿï¼Œæˆ‘æš‚æ—¶æŠŠå®ƒå½“åšPropTypeåœ¨ç”¨ï¼ˆä»¥å‰æ—©æœŸçš„æ—¶å€™æˆ‘ä»¬éƒ½ä¼šå®šä¹‰PropTypeä¿è¯ç»„ä»¶çš„å…¥å‚ï¼‰ã€‚
  
  è¿™é‡Œæˆ‘å®šä¹‰äº†RequestInfoPropså‚æ•°ï¼Œä½œä¸ºRequestInfoListç»„ä»¶çš„å…¥å‚ï¼Œæœ‰ä¸€éƒ¨åˆ†å¯ä»¥çœç•¥ï¼Œæ¯”å¦‚emptytextï¼Œä¹Ÿå¯ä»¥ç»™`é»˜è®¤å€¼`ã€‚
  
  å¯ä»¥çœ‹åˆ°ï¼Œtsxé™¤äº†ä¸€äº›å˜é‡ç±»å‹çš„å£°æ˜ï¼Œinterfaceçš„å®šä¹‰ï¼Œ<æ³›å‹>çš„ä½¿ç”¨ï¼Œå…¶ä»–å’Œjsxä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼ˆå®‰æ…°ä½ ä»¬ï¼Œä¹Ÿå®‰æ…°æˆ‘è‡ªå·±ï¼Œå¯ä»¥å°è¯•ä¸‹å˜›ï¼‰
  
  `å¯¹äºæˆ‘æ¥è¯´ï¼Œå°½é‡ä¸ç”¨anyå°±è¡Œäº†ï¼Œå…å¾—å†™æˆäº†any script.`
  
  æŠ½å‡ºç»„ä»¶ä»¥åå‘¢ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¼ å…¥dataSourceäº†ï¼Œå› ä¸ºè¿™å—å†…å®¹æ˜¯ä¼šç”±ä»–çš„`çˆ¶ç»„ä»¶`å†³å®šã€‚
  
  æ¥ç€æˆ‘ä»¬ç¼–å†™çˆ¶ç»„ä»¶éƒ¨åˆ†ï¼ŒåŸºæœ¬ä¸Šæ ¹æ®ç”¨æˆ·ç‚¹å‡»`harå¯¼å…¥`å’Œ`å½•åˆ¶æ•°æ®`æŒ‰é’®ï¼Œå°±å¯ä»¥å†³å®šdataSourceäº†ï¼Œå¦‚æœdataSourceä¸ºç©ºï¼Œè¿˜å¾—ç»™ä¸ªå‹å¥½æç¤ºï¼Œè®©ç”¨æˆ·å»`å½•åˆ¶é¡µé¢`å½•åˆ¶å»ã€‚
  
  æˆ‘ä»¬çš„è¿™ä¸ªè¡¨å•æ˜¯æ”¾åˆ°Drawerçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªDrawerçš„tsxï¼Œå¹¶æŠŠå¼€å¯/å…³é—­`æŠ½å±‰`çš„æƒåˆ©èµ‹ç»™TestCaseDirectory.jsxç»„ä»¶ã€‚
  
  ç”±äºå‰ç«¯ä»£ç å¾ˆå ç¯‡å¹…ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠ½ä¸€éƒ¨åˆ†å‡ºæ¥è®²è§£:
 

```tsx
    <Drawer title="ç”Ÿæˆç”¨ä¾‹" onClose={() => setVisible()} visible={visible} width={960} extra={
      <Button onClick={onGenerateCase} type="primary"><FireOutlined/> ç”Ÿæˆç”¨ä¾‹</Button>
    }>
      <Form form={form} {...CONFIG.SUB_LAYOUT}>
        <Row gutter={8}>
          <Col span={12}>
            <Form.Item label="ç”¨ä¾‹ç›®å½•" name="directory_id" rules={[{required: true, message: 'è¯·é€‰æ‹©ç”¨ä¾‹ç›®å½•'}]}>
              <TreeSelect placeholder="è¯·é€‰æ‹©ç”¨ä¾‹ç›®å½•" treeLine treeData={directory}/>
            </Form.Item>
          </Col>
          <Col span={12}>
            <Form.Item label="ç”¨ä¾‹åç§°" name="name" rules={[{required: true, message: 'è¯·è¾“å…¥ç”¨ä¾‹åç§°'}]}>
              <Input placeholder="è¯·è¾“å…¥ç”¨ä¾‹åç§°"/>
            </Form.Item>
          </Col>
        </Row>
      </Form>
      {
        record.length === 0 ?
          <Empty image={NoRecord} imageStyle={{height: 220}} description="å½“å‰æ²¡æœ‰ä»»ä½•è¯·æ±‚æ•°æ®ï¼Œä½ å¯ä»¥é€‰æ‹©ã€å½•åˆ¶ã€‘åçš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å¯¼å…¥haræ–‡ä»¶æå–æ¥å£ğŸ‘">
            <Space>
              <Button onClick={onLoadRecords}><CameraOutlined/> å½•åˆ¶è¯·æ±‚</Button>
              <Upload showUploadList={false} customRequest={onUpload} fileList={[]}>
                <Button type="primary">
                  <ImportOutlined/>
                  å¯¼å…¥Har
                </Button>
              </Upload>
            </Space>
          </Empty> :
          <RequestInfoList dataSource={record} rowSelection={rowSelection} rowKey="index"
                           loading={loading.effects['recorder/generateCase']}/>
      }
    </Drawer>
```
  
  è¿™ä¸ªç±»ä¼¼htmlçš„é¡µé¢ï¼Œæ˜¯æˆ‘ä»¬çš„è§†å›¾å±‚ã€‚æˆ‘ä»¬çš„å¸ƒå±€æ˜¯è¿™æ ·, å¯¹ç€ä»£ç çœ‹ç•Œé¢:

![](http://oss.pity.fun/picture/20220619220921.png)

  ä¸Šé¢2ä¸ªå­—æ®µå±äºè¡¨å•ä¹Ÿå°±æ˜¯Formï¼Œä¸‹é¢çš„å­—æ®µå±äºRequestInfoç»„ä»¶æˆ–è€…Emptyï¼ˆéšç€æ˜¯å¦æœ‰æ•°æ®åˆ‡æ¢ï¼‰ï¼Œæ¥ç€å°±æ˜¯å³ä¸Šè§’çš„ç”ŸæˆæŒ‰é’®ã€‚
  
  åç»­å¯¹ç€ç¼–å†™äº‹ä»¶å³å¯ï¼Œå…¶å®å‰ç«¯ä¹Ÿä¸ç®—`å¤æ‚`ï¼Œç®€å•çš„è¿˜æ˜¯å¾ˆå¥½å†™çš„ï¼Œå°±æ˜¯è¿›é˜¶æ„Ÿè§‰å¾ˆéš¾ã€‚
  
### æœ€åæ¥çœ‹çœ‹æ•ˆæœ

  `åˆ«å¿˜è®°ç”Ÿæˆåå…³é—­å¯¹è¯æ¡†ï¼Œå¹¶ä¸”é‡æ–°è·å–ç›®å½•ä¸‹çš„caseå“¦~`

![](http://oss.pity.fun/picture/%E5%8A%A8234.gif)

  è¿™æ ·ï¼Œä¸€ä»½ç²—ç³™çš„`ç”¨ä¾‹ç”Ÿæˆ`å°±å®Œäº‹äº†ï¼Œå…¶å®è¿˜æœ‰`ç”¨ä¾‹å½•åˆ¶`é¡µé¢æ²¡æœ‰å®Œæˆï¼Œé‚£ä¸ªå°±å…ˆæç€å§ï¼Œéœ€è¦ç ”ç©¶ä¸€ä¸‹mitmproxyä¸­çš„ä¸€ä¸ªå‚æ•°ï¼Œæš‚ä¸”å–ä¸ªå…³å­ã€‚


  


  


  